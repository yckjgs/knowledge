

> ç¯å¢ƒ:è…¾è®¯äº‘è½»é‡æœåŠ¡å™¨ï¼šCentOS CPU - 2æ ¸ å†…å­˜ - 4GBï¼ˆåŸæ¥ä½¿ç”¨çš„å†…å­˜æ˜¯2GBæ„å»ºæ€»æ˜¯å¡æ­»ï¼Œå‡çº§ä¸º4GBï¼‰
>
> ç›®æ ‡:å®ç°æ¨é€ä»£ç åï¼Œè‡ªåŠ¨è¿›è¡Œæ„å»ºéƒ¨ç½²ï¼Œç½‘ç«™åˆ·æ–°å³å¯å±•ç¤ºæœ€æ–°æ•ˆæœ.

å†…å®¹è¾ƒé•¿ï¼Œä¸”çœ‹ä¸”è€å¿ƒï¼ğŸ’ª

# ä¸€ã€å‰è¨€

Jenkinsæ˜¯ä¸€ä¸ªå¼€æºè½¯ä»¶é¡¹ç›®ï¼Œæ˜¯åŸºäºJavaå¼€å‘çš„ä¸€ç§æŒç»­é›†æˆå·¥å…·ï¼Œç”¨äºç›‘æ§æŒç»­é‡å¤çš„å·¥ä½œï¼Œæ—¨åœ¨æä¾›ä¸€ä¸ªå¼€æ”¾æ˜“ç”¨çš„è½¯ä»¶å¹³å°ï¼Œä½¿è½¯ä»¶çš„æŒç»­é›†æˆå˜æˆå¯èƒ½ã€‚

![jenkinsåŸºç¡€å·¥ä½œåŸç†](https://s2.51cto.com/images/blog/202405/31170601_665992f967abc35071.png)

ä¸€ã€é¡¹ç›®éƒ¨ç½²å’ŒDevOps
1.1ã€ä¼ ç»Ÿçš„å¼€å‘æ¨¡å¼
åœ¨ä¼ ç»Ÿçš„å¼€å‘æ¨¡å¼ä¸­ï¼Œå¼€å‘çš„æ•´ä¸ªè¿‡ç¨‹æ˜¯æŒ‰éƒ¨å°±ç­å°±è¡Œï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/8e50ede67de54e2a8ea220da4b400c34.png#pic_center)

ä½†æ˜¯è¿™ç§æ¨¡å¼å­˜åœ¨å¾ˆå¤§çš„å¼Šç«¯ï¼š

å·¥ä½œçš„ä¸åè°ƒï¼šå¼€å‘äººå‘˜åœ¨å¼€å‘é˜¶æ®µï¼Œæµ‹è¯•å’Œè¿ç»´äººå‘˜å…¶å®æ˜¯å¤„äºç­‰å¾…çš„çŠ¶æ€ã€‚ç­‰åˆ°æµ‹è¯•é˜¶æ®µï¼Œå¼€å‘äººå‘˜ç­‰å¾…æµ‹è¯•åé¦ˆbugï¼Œä¹Ÿä¼šå¤„äºç­‰å¾…çŠ¶æ€ã€‚
çº¿ä¸Šbugçš„éšæ‚£ï¼šé¡¹ç›®å‡†å¤‡äº¤ä»˜æ—¶ï¼Œçªç„¶å‡ºç°äº†bugï¼Œæ‰€æœ‰äººå‘˜éœ€è¦åŠ ç­ã€ç­‰å¾…é—®é¢˜çš„å¤„ç†ï¼›
1.2ã€DevOpså¼€å‘æ¨¡å¼
DevOpsæ˜¯Developmentå’ŒOperationsä¸¤ä¸ªè¯çš„ç»“åˆï¼Œå°†å¼€å‘å’Œè¿ç»´ç»“åˆèµ·æ¥çš„æ¨¡å¼ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/9b7a25c6b9c64e4fafa5a2998073b2e0.png#pic_center)



1.3ã€æŒç»­é›†æˆå’ŒæŒç»­äº¤ä»˜
ä¼´éšç€DevOpsä¸€èµ·å‡ºç°çš„ä¸¤ä¸ªè¯å°±æ˜¯æŒç»­é›†æˆå’ŒæŒç»­äº¤ä»˜(éƒ¨ç½²)ï¼š

CIæ˜¯Continuous Integrationï¼ˆæŒç»­é›†æˆï¼‰ï¼›
CDæ˜¯ä¸¤ç§ç¿»è¯‘ï¼šContinuous Deliveryï¼ˆæŒç»­äº¤ä»˜ï¼‰æˆ–Continuous Deploymentï¼ˆæŒç»­éƒ¨ç½²ï¼‰ï¼›
æŒç»­é›†æˆCIï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/b21445fded894a33b837a4abcf236d31.png#pic_center#pic_center)

æŒç»­äº¤ä»˜å’ŒæŒç»­éƒ¨ç½²ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/6082d6fe09bd4e118780f427a235ecdb.png#pic_center)

![](https://i-blog.csdnimg.cn/direct/393aa0c64c6b4a60a0acd364ac714d41.png#pic_center)

1.4ã€è‡ªåŠ¨åŒ–éƒ¨ç½²æµç¨‹

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/5e586b04a9514c989a8f03dccf72775d.png#pic_center)

ä¸€.Dockerå®‰è£…Jenkinsæ’ä»¶

1.å¯åŠ¨dockerï¼Œä¸‹è½½Jenkinsé•œåƒæ–‡ä»¶

>docker -v
>docker pull jenkins/jenkins

![image-20241023174415285](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241023174415285.png)

2.åˆ›å»ºJenkinsæŒ‚è½½ç›®å½•å¹¶æˆæƒæƒé™

>mkdir -p /var/jenkins_mount
>chmod 777 /var/jenkins_mount

3.åˆ›å»ºå¹¶å¯åŠ¨Jenkinså®¹å™¨

> docker run -d -p 10240:8080 -p 10241:50000 -v /var/jenkins_mount:/var/jenkins_home -v /etc/localtime:/etc/localtime --name jenkins jenkins/jenkins:lts

å‚æ•°è¯´æ˜:

ã€€-d åå°è¿è¡Œé•œåƒ

ã€€-p 10240:8080 å°†é•œåƒçš„8080ç«¯å£æ˜ å°„åˆ°æœåŠ¡å™¨çš„10240ç«¯å£ã€‚

ã€€-p 10241:50000 å°†é•œåƒçš„50000ç«¯å£æ˜ å°„åˆ°æœåŠ¡å™¨çš„10241ç«¯å£

ã€€-v /var/jenkins_mount:/var/jenkins_mount /var/jenkins_homeç›®å½•ä¸ºå®¹å™¨jenkinså·¥ä½œç›®å½•ï¼Œæˆ‘ä»¬å°†ç¡¬ç›˜ä¸Šçš„ä¸€ä¸ªç›®å½•æŒ‚è½½åˆ°è¿™ä¸ªä½ç½®ï¼Œæ–¹ä¾¿åç»­æ›´æ–°é•œåƒåç»§ç»­ä½¿ç”¨åŸæ¥çš„å·¥ä½œç›®å½•ã€‚è¿™é‡Œæˆ‘ä»¬è®¾ç½®çš„å°±æ˜¯ä¸Šé¢æˆ‘ä»¬åˆ›å»ºçš„ /var/jenkins_mountç›®å½•

ã€€-v /etc/localtime:/etc/localtimeè®©å®¹å™¨ä½¿ç”¨å’ŒæœåŠ¡å™¨åŒæ ·çš„æ—¶é—´è®¾ç½®ã€‚

ã€€--name myjenkins ç»™å®¹å™¨èµ·ä¸€ä¸ªåˆ«å

![image-20241023174900589](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241023174900589.png)

4.æŸ¥çœ‹dockerå®¹å™¨æ—¥å¿—ã€‚

>docker ps -l #æŸ¥çœ‹jenkinsæ˜¯å¦å¯åŠ¨æˆåŠŸï¼Œå¦‚ä¸‹å›¾å‡ºç°ç«¯å£å·ï¼Œå°±ä¸ºå¯åŠ¨æˆåŠŸäº†
>docker logs myjenkins

5.é…ç½®é•œåƒåŠ é€Ÿï¼Œè¿›å…¥cd /var/jenkins_mount/ç›®å½•,ä¿®æ”¹hudson.model.UpdateCenter.xmlæ–‡ä»¶å†…å®¹ã€‚

![docker éƒ¨ç½²jenkins ç¨³å®šç‰ˆæœ¬ jenkins dockerå®‰è£…_Jenkins_09](https://s2.51cto.com/images/blog/202405/31170602_665992fa9f33448386.png)

æ³¨:å°†urlä¿®æ”¹ä¸ºæ¸…åå¤§å­¦å®˜æ–¹é•œåƒ:https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json

6.è®¿é—®Jenkinsé¡µé¢ï¼Œè¾“å…¥ä½ çš„ip:10240

![docker éƒ¨ç½²jenkins ç¨³å®šç‰ˆæœ¬ jenkins dockerå®‰è£…_docker_10](https://s2.51cto.com/images/blog/202405/31170602_665992fad115f96785.png)

7.æŸ¥çœ‹ç®¡ç†å‘˜å¯†ç 

> cat /var/jenkins_mount/secrets/initialAdminPassword

![docker éƒ¨ç½²jenkins ç¨³å®šç‰ˆæœ¬ jenkins dockerå®‰è£…_Jenkins_12](https://s2.51cto.com/images/blog/202405/31170603_665992fb33ef273543.png?)

åˆ°æ­¤ä»¥å…¨éƒ¨å®‰è£…æˆåŠŸï¼Œå°½æƒ…çš„ä½¿ç”¨å§ï¼

å®å¡”å®‰è£…è¡¥å……:

åœ¨`è½¯ä»¶å•†åº—`æœç´¢å®‰è£…Jenkinsæ’ä»¶

![image-20241023112020208](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241023111920103.png)

ç‚¹å‡»è¿›å…¥è®¾ç½®ï¼Œ`é€‰æ‹©ä¸ä½¿ç”¨åŸŸå`ï¼Œ`å…è®¸å¤–éƒ¨è®¿é—®`ï¼Œå®‰è£…åº”ç”¨

 ![image-20241023112020208](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241023112020208.png)

<img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241023142520035.png" alt="image-20241023112020208" style="zoom:50%;" />

æç¤ºæˆåŠŸåæ‰“å¼€è®¿é—®è¿æ¥ï¼Œç™»å½•å¯†ç åœ¨åº”ç”¨ä¿¡æ¯ä¸­è·å–ï¼Œ

 ![image-20241023142855470](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241023142855470.png)

äºŒã€éƒ¨ç½²é¡¹ç›®å‰-å®‰è£…æ’ä»¶åŠç›¸å…³é…ç½®

é¡¹ç›®çš„éƒ¨ç½²ä¸»è¦å‚è€ƒäº†ç½‘å‹linuxä¸­ä½¿ç”¨jenkinsè‡ªåŠ¨éƒ¨ç½²å‰ç«¯å·¥ç¨‹ çš„åšå®¢ï¼Œåœ¨æ­¤è¡¨è¾¾æ„Ÿè°¢ï¼

![image-20241025234537143](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241025234537143.png)

å®‰è£…ä¹‹å‰å…ˆç¡®è®¤æœåŠ¡å·²å¯åŠ¨ã€‚

SpringBootå‰åç«¯é¢å¤–å®‰è£…æ’ä»¶å¦‚ä¸‹ï¼š

Locale Plugin(Jenkinsç¯å¢ƒè¯­è¨€æ±‰åŒ–)

NodeJS Pluginï¼ˆnodejsç¯å¢ƒ-->ç”¨äºå‰ç«¯æ„å»ºæ‰“åŒ…ï¼‰

Maven Integrationï¼ˆjavaç¯å¢ƒ-->ç”¨äºåç«¯æ„å»ºæ‰“åŒ…ï¼‰

Publish over SSH ï¼ˆç”¨äºæ‰§è¡Œæ„å»ºåçš„æ“ä½œ-->ç”¨äºè¿œç¨‹ä¼ è¾“æ–‡ä»¶ï¼Œ`åˆ‡è®°dockerç¯å¢ƒcpä¸è¦ç”¨ï¼Œåªèƒ½SSHä¼ è¾“éƒ¨ç½²`ï¼‰

Git Plugin(ç”¨äºæ‹‰å–å‰åç«¯ä»£ç åˆ°æœ¬åœ°)

Coding Webhook (Codingä»£ç åº“é¡»è£…)

Gitee Pluginï¼ˆgiteeä»£ç åº“é¡»è£…ï¼‰

1ã€ç‚¹å‡»ç³»ç»Ÿç®¡ç† -> æ’ä»¶ç®¡ç†

![jenkinså®‰è£…éƒ¨ç½²å‰åç«¯ç®€ç‰ˆ jenkins å‰ç«¯éƒ¨ç½²_jenkinså®‰è£…éƒ¨ç½²å‰åç«¯ç®€ç‰ˆ_04](https://s2.51cto.com/images/blog/202406/28021053_667dab2d7958089883.jpg?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=/format,webp/resize,m_fixed,w_1184)

 2ã€æœç´¢æ’ä»¶å¹¶å®‰è£…

![jenkinså®‰è£…éƒ¨ç½²å‰åç«¯ç®€ç‰ˆ jenkins å‰ç«¯éƒ¨ç½²_java_05](https://s2.51cto.com/images/blog/202406/28021053_667dab2dd988132761.jpg?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=/format,webp/resize,m_fixed,w_1184)

`å®‰è£…æ’ä»¶ä¹‹ååˆ‡è®°é‡å¯Jenkinsã€‚`

 3ã€å…¨å±€å·¥å…·é…ç½®

 ç‚¹å‡»ç³»ç»Ÿç®¡ç†->å…¨å±€å·¥å…·é…ç½®ï¼Œè¿›è¡Œé…ç½®gitå’Œnode

![jenkinså®‰è£…éƒ¨ç½²å‰åç«¯ç®€ç‰ˆ jenkins å‰ç«¯éƒ¨ç½²_jenkinså®‰è£…éƒ¨ç½²å‰åç«¯ç®€ç‰ˆ_06](https://s2.51cto.com/images/blog/202406/28021054_667dab2e34d0c6480.jpg?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=/format,webp/resize,m_fixed,w_1184)

![image-20241025235726868](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241025235726868.png)

é…ç½®ä¿¡æ¯å¡«å®Œåä¿å­˜å³å¯ã€‚

4ã€ç³»ç»Ÿé…ç½®(Publish over SSH)

![jenkinså®‰è£…éƒ¨ç½²å‰åç«¯ç®€ç‰ˆ jenkins å‰ç«¯éƒ¨ç½²_jenkinså®‰è£…éƒ¨ç½²å‰åç«¯ç®€ç‰ˆ_07](https://s2.51cto.com/images/blog/202406/28021055_667dab2f4995e80199.jpg?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=/format,webp/resize,m_fixed,w_1184)

![image-20241026000100416](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241026000100416.png)

 å†™å…¥æœåŠ¡å™¨å¯†ç æˆ–keyï¼Œå†™å®Œä¿¡æ¯ç‚¹å‡»å³ä¸‹è§’Test Configurationç¡®è®¤æ˜¯å¦é…ç½®æˆåŠŸæµ‹è¯•æˆåŠŸï¼

5.é…ç½®Gitä»£ç åº“è´¦æˆ·å‡­è¯

![image-20241026000559180](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241026000559180.png)

ä¸‰ã€éƒ¨ç½²å‰åç«¯é¡¹ç›®

1ï¼‰

![image-20241026002233676](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241026002233676.png)

```
#!/bin/bash
#é»˜è®¤æ ¹ç›®å½•:/var/jenkins_mount/workspace/mes-ui
#æŸ¥çœ‹ç‰ˆæœ¬å·
node -v
npm -v
#åŠ è½½ä¾èµ–
npm install --force --registry=https://registry.npmmirror.com
#æ„å»ºä»£ç 
npm run build:prod
#è¿›å…¥distç›®å½•
cd dist
#ç§»é™¤ä¹‹å‰çš„å‹ç¼©åŒ…
rm -f dist.tar.gz
#æŠŠå½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶æ‰“åŒ…æˆdist.tar.gz
tar -zcvf dist.tar.gz *
```

```
cd /www/wwwroot/java/dist
tar -zxvf dist.tar.gz
rm -f dist.tar.gz
#é‡å¯Nginx
sudo systemctl restart nginx
echo "æ„å»ºéƒ¨ç½²å®Œæˆ"
```

```
# !bin/bash
#æŸ¥çœ‹nginxè¿›ç¨‹
ps -ef | grep nginx
```

2)åå°é…ç½®

![image-20241026002656010](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241026002656010.png)

```
#é»˜è®¤ç›®å½•:/var/jenkins_mount/workspace/mes
#æŸ¥çœ‹ç‰ˆæœ¬å·
java -version
mvn -v
#åˆ‡æ¢äº†ç¼–è¯‘åçš„ç›®å½•
cd t3rik-erp/target
#ç§»é™¤ä¹‹å‰çš„å‹ç¼©åŒ…
rm -f mes.tar.gz
#æŠŠå½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶æ‰“åŒ…æˆmes.tar.gz
tar -zcvf mes.tar.gz t3rik-erp.jar
```

```
clean install -Dmaven.test.skip=true -U
```

```
#é»˜è®¤ç›®å½•:/var/jenkins_mount/workspace/mes
#æŸ¥çœ‹ç‰ˆæœ¬å·
java -version
mvn -v
#åˆ‡æ¢äº†ç¼–è¯‘åçš„ç›®å½•
cd t3rik-erp/target
#ç§»é™¤ä¹‹å‰çš„å‹ç¼©åŒ…
rm -f mes.tar.gz
#æŠŠå½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶æ‰“åŒ…æˆmes.tar.gz
tar -zcvf mes.tar.gz t3rik-erp.jar
```

#æŸ¥çœ‹ç‰ˆæœ¬
java -version
cd /www/wwwroot/java
tar -zxvf mes.tar.gz
rm -f mes.tar.gz
```
# è·å–Javaè¿›ç¨‹ID
PID=$(ps -ef | grep 't3rik-erp.jar' | grep -v grep | awk '{print $2}')
if [ -n "$PID" ]; then
    kill -15 $PID
    kill -9 $PID
fi
# ç­‰å¾…1ç§’
sleep 1
/www/server/java/jdk-20.0.2/bin/java  -jar -Xmx1024M -Xms256M  /www/wwwroot/java/t3rik-erp.jar --server.port=8762 > release_out.log
echo "æ„å»ºéƒ¨ç½²å®Œæˆ"
```

```
#æŸ¥çœ‹javaè¿›ç¨‹
ps -ef | grep java
```



2ã€é…ç½® æºç ç®¡ç†

 é€‰æ‹©gitï¼Œè¡¥å……çº¢æ¡†çš„ä¿¡æ¯

 giteeçš„å‡­è¯éœ€è¦å…ˆç‚¹å‡»æ·»åŠ ï¼Œå†™å…¥ç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œç„¶ååœ¨ä¸‹æ‹‰é€‰æ‹©å³å¯

 åˆ†æ”¯é»˜è®¤masterï¼Œå¯æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹

![jenkinså®‰è£…éƒ¨ç½²å‰åç«¯ç®€ç‰ˆ jenkins å‰ç«¯éƒ¨ç½²_ç¬”è®°_10](https://s2.51cto.com/images/blog/202406/28021057_667dab31d83c142711.jpg?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=/format,webp/resize,m_fixed,w_1184)









3ã€é…ç½® æ„å»ºè§¦å‘å™¨

 é€‰æ‹© Gitee webhookè§¦å‘æ„å»ºã€‚ã€‚ã€‚

![jenkinså®‰è£…éƒ¨ç½²å‰åç«¯ç®€ç‰ˆ jenkins å‰ç«¯éƒ¨ç½²_jenkins_11](https://s2.51cto.com/images/blog/202406/28021058_667dab323471a94418.jpg?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=/format,webp/resize,m_fixed,w_1184)

 ä¿®æ”¹ å…è®¸è§¦å‘æ„å»ºçš„åˆ†æ”¯ ï¼Œå¹¶ç”Ÿæˆ webhookå¯†ç 

![jenkinså®‰è£…éƒ¨ç½²å‰åç«¯ç®€ç‰ˆ jenkins å‰ç«¯éƒ¨ç½²_jenkins_12](https://s2.51cto.com/images/blog/202406/28021058_667dab329315277979.jpg?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=/format,webp/resize,m_fixed,w_1184)

 å»giteeä»“åº“é…ç½®webhook

![jenkinså®‰è£…éƒ¨ç½²å‰åç«¯ç®€ç‰ˆ jenkins å‰ç«¯éƒ¨ç½²_java_13](https://s2.51cto.com/images/blog/202406/28021058_667dab32ee07424274.jpg?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=/format,webp/resize,m_fixed,w_1184)

è¡¥å……ä¸‹é¢ä¿¡æ¯:

URLå³ä¸ºå‹¾é€‰æ„å»ºè§¦å‘å™¨æ—¶ï¼Œæç¤ºURL

å¯†ç æ˜¯ä¸Šé¢ç”Ÿæˆçš„

 æ·»åŠ å®Œæˆåï¼Œä¼šè¿›è¡Œè¯·æ±‚æµ‹è¯•ï¼Œä»Šå¤©æµ‹è¯•ç»“æ„éƒ½å¤±è´¥äº†å‘¢ï¼Œè¯•äº†ä¸€ä¸ªä¹‹å‰çš„ä¹Ÿæ˜¯404ä½†æ„å»ºæ²¡é—®é¢˜ï¼Œå§‘ä¸”æ”¾ä¸€æ”¾ï¼Œçœ‹åæ¥æ„å»ºæ˜¯å¦æœ‰å½±å“



 5ã€é…ç½® Build Steps

å¢åŠ æ„å»ºæ­¥éª¤->é€‰æ‹© æ‰§è¡Œshell

```
node -v
npm -v

#åˆ¤æ–­-start å¦‚æœå­˜åœ¨/usr/local/nginx/html/hello
if [-d /usr/local/nginx/html/hello]
    echo 'å½“å‰å­˜åœ¨/usr/local/nginx/html/helloç›®å½•'
    #æ—¶é—´æˆ³
    TIMESTAMP=$(date+"%y%m%d%H%M%S")
    #å¤‡ä»½
    sudo mv /usr/local/nginx/html/vues '/usr/local/nginx/html/hello_'TIMESTAMP
else
   echo 'å½“å‰å­˜åœ¨/usr/local/nginx/html/helloç›®å½•'
fi
#åˆ¤æ–­-end
npm install
npm run build
```

 è¿™é‡Œä¸»è¦æ˜¯å°†nginxçš„ä»£ç è¿›è¡Œå¤‡ä»½ç§»é™¤ï¼Œå¹¶è¿›è¡Œinstallå’Œbuild

å¢åŠ æ„å»ºæ­¥éª¤->é€‰æ‹© Send files or execute commands over SSH

 é€šè¿‡sshè®²æ‰“åŒ…åçš„æ–‡ä»¶å‘é€åˆ°æŒ‡å®šç›®å½•ï¼ŒåŠnginxé…ç½®çš„åŒ…ä½ç½®

 jenkinsç”Ÿæˆçš„æ–‡ä»¶åœ¨/var/lib/jenkins/workspace

 è‡³æ­¤ å®Œæˆäº†é¡¹ç›®çš„é…ç½®ï¼Œ

å››ã€æ„å»º

ç‚¹å‡»ã€ç«‹å³æ„å»ºã€‘æˆ–æäº¤ä»£ç éƒ½èƒ½è¿›è¡Œè‡ªåŠ¨æ„å»ºéƒ¨ç½²

![jenkinså®‰è£…éƒ¨ç½²å‰åç«¯ç®€ç‰ˆ jenkins å‰ç«¯éƒ¨ç½²_jenkinså®‰è£…éƒ¨ç½²å‰åç«¯ç®€ç‰ˆ_14](https://s2.51cto.com/images/blog/202406/28021101_667dab356634124577.jpg?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=/format,webp/resize,m_fixed,w_1184)

![jenkinså®‰è£…éƒ¨ç½²å‰åç«¯ç®€ç‰ˆ jenkins å‰ç«¯éƒ¨ç½²_å‰ç«¯_15](https://s2.51cto.com/images/blog/202406/28021101_667dab35b5f0d40354.jpg?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=/format,webp/resize,m_fixed,w_1184)

 å¦‚æœæˆåŠŸï¼Œåˆ™

![jenkinså®‰è£…éƒ¨ç½²å‰åç«¯ç®€ç‰ˆ jenkins å‰ç«¯éƒ¨ç½²_ç¬”è®°_16](https://s2.51cto.com/images/blog/202406/28021102_667dab361d89879125.jpg?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=/format,webp/resize,m_fixed,w_1184)

 å¦‚æœå¤±è´¥ï¼Œçœ‹çœ‹logï¼Œé”™å“ªé‡Œäº†è¿›è¡Œä¿®æ”¹

![jenkinså®‰è£…éƒ¨ç½²å‰åç«¯ç®€ç‰ˆ jenkins å‰ç«¯éƒ¨ç½²_java_17](https://s2.51cto.com/images/blog/202406/28021102_667dab3675e214445.jpg?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=/format,webp/resize,m_fixed,w_1184)

ç¾å¥½çš„ä¸€å¤©ç»“æŸäº†ï¼